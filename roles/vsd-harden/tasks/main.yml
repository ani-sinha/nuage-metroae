---

#### Add something to check if user exists and skip creating user
- name: Check if user exists
  command: id -u user6
  register: user_exists
  ignore_errors: yes

- block:
  - name: Create a SSH pass
    command: openssl passwd -1 caso
    register: openssl_pwd 

  - name: Create the user if not present
    command: useradd -p openssl_pwd.stdout user6
  when: "'no such user' in user_exists.stderr"

### Check if user is present in sudoers list
- name: Check if user is present in sudoers list
  command: sudo -l -U user6
  register: user_not_in_sudoers
  ignore_erros: yes

### If not add user to sudoers list
- name: Add user to sudoers list
  command: usermod -aG wheel user6
  when: "'not allowed' in user_not_in_sudoers.stdout"

### Todo: Disable root access

