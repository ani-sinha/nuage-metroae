- block:

  - name: Set NSGV KVM image location
    include_role:
      name: common
      tasks_from: find-image.yml
    vars:
      pattern: sros-vm.qcow2
    when: vsrs | map(attribute='target_server_type') | list is issuperset(["kvm"])

  - name: Set NSGV vCenter image location
    include_role:
      name: common
      tasks_from: find-image.yml
    vars:
      pattern: sros-vm.ova
    when: vsrs | map(attribute='target_server_type') | list is issuperset(["vcenter"])

  - name: Create host_vars files for vsr
    template: src=vsr.j2 backup=no dest={{ inventory_dir }}/host_vars/{{ item.hostname }}
    with_items: "{{ vsrs }}"

  when:
    - vsrs is defined and vsrs
  tags:
    - vsr
