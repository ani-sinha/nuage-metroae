---
- hosts: localhost
  vars:
    report_filename: ./vsd_upgrade_report.txt

  tasks:
  - name: Clean up tmp files from previous runs
    file: path="{{ report_filename }}" state=absent
  - name: Write title to report file
    nuage_append: filename="{{ report_filename }}" text="VSD Upgrade Report Start\n"
  - name: Write date to report file
    nuage_append: filename="{{ report_filename }}" text="{{ ansible_date_time.date }}@{{ ansible_date_time.time }}\n"
  - name: Write seperator to report file
    nuage_append: filename="{{ report_filename }}" text="================================================================================\n"

- include: vsd_upgrade_helper.yml report_filename=./vsd_upgrade_report.txt

- hosts: localhost
  vars:
    report_filename: ./vsd_upgrade_report.txt
  tasks:
  - name: Write seperator to report file
    nuage_append: filename="{{ report_filename }}" text="================================================================================\n"
  - name: Write out footer
    nuage_append: filename="{{ report_filename }}" text="VSD Upgrade Report End\n"
