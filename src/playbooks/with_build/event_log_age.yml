---
- hosts: localhost
  gather_facts: yes
  tasks:
    - name: Format VSPK auth for VSPK module
      set_fact:
        vspk_auth:
          api_username: "csproot"
          api_password: "csproot"
          api_enterprise: "csp"
          api_url: "https://vsd1.example.com:8443"
          api_version: v5_0

    - name: Format VSPK auth for VSPK module
      set_fact:
        nuage_auth:
          username: "csproot"
          password: "csproot"
          api_url: "https://vsd1.example.com:8443"
          enterprise: csp

    - name: Get Sysconfig
      nuage_vspk:
        auth: "{{ vspk_auth }}"
        type: SystemConfig
        command: find
      register: sysconfig


    - name: Enable maintainance mode on all l3/l2 domains
      set_event_log:
        vsd_auth:
          "{{ nuage_auth }}"
        event_log_age: 9
        api_version: 5
      register: mode_status
