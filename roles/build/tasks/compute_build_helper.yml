---
- name: Set mycomputes_check
  set_fact: mycomputes_check={{myinfras is defined}}
 
- name: Assign empty list to mycomputes if it is undefined
  set_fact: mycomputes= default([])
  when: not mycomputes_check
 
- name: Create host_vars files for compute server
  template: src=compute.j2 backup=no dest={{ playbook_dir }}/host_vars/{{ item.hostname }}
  with_items: "{{ mycomputes }}"
  when: mycomputes_check
