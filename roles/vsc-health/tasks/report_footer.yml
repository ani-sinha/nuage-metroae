- name: Write seperator to report file
  nuage_append: filename="{{ report_path }}" text="================================================================================\n"
  delegate_to: localhost
  run_once: true

- name: Write title to report file
  nuage_append: filename="{{ report_path }}" text="VSC Health Report End\n"
  delegate_to: localhost
  run_once: true

- name: Lookup the error report file
  stat:
    path: "{{ failure_path }}"
  register: report
  
- name : Print out all the vsc health failures      
  debug: msg="the value of Error file is   {{ lookup('file',  failure_path ) }} "  
  when:  report.stat.exists  

- name: Check for failures
  assert: {
    that: "not report.stat.exists",
    msg: "Failures detected. Check {{ failure_report_file_name }}."
    }