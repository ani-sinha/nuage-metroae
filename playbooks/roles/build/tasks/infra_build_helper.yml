---
- name: Set myinfras_check
  set_fact: myinfras_check={{myinfras is defined}}

- name: Assign empty list to myinfras if it is undefined
  set_fact: myinfras= default([])
  when: not myinfras_check

- name: Create host_vars files for infra server
  template: src=infra.j2 backup=no dest={{ playbook_dir }}/host_vars/{{ item.hostname }}
  with_items: "{{ myinfras }}"
  when: myinfras_check
