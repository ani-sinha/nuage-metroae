---
- hosts: vsds
  gather_facts: no
  any_errors_fatal: true
  vars:
    report_filename: vsp_preupgrade_health_report_for_vsd.txt
    ansible_become_pass: "{{ vsd_custom_password | default(vsd_default_password) }}"
    vsd_username: "{{ vsd_custom_username | default(vsd_default_username) }}"
  roles:
    - vsd-health
  become: "{{ 'no' if vsd_custom_username | default(vsd_default_username) == 'root' else 'yes' }}"
  remote_user: "{{ vsd_custom_username | default(vsd_default_username) }}"  

- hosts: vstats
  gather_facts: no
  serial: 1
  any_errors_fatal: true
  vars:
    report_filename: vstat_preupgrade_health_report.txt
    vstat_username: "{{ vstat_custom_username | default(vstat_default_username) }}"
    vstat_password: "{{ vstat_custom_password | default(vstat_default_password) }}"
  roles:
    - vstat-health

- hosts: vcins
  gather_facts: no
  serial: 1
  any_errors_fatal: true
  vars:
    report_filename: vcin_preupgrade_health_report.txt
    vsd_username: "{{ vsd_custom_username | default(vsd_default_username) }}"
  roles:
    - vcin-health

- hosts: vscs
  gather_facts: no
  serial: 1
  any_errors_fatal: true
  connection: local
  vars:
    report_filename: vsp_preupgrade_health_report_for_vsc.txt
  roles:
    - vsc-health

- hosts: vsds
  gather_facts: no
  vars:
    report_filename: vstat_preupgrade_health_report_for_vsd.txt
    vsd_username: "{{ vsd_custom_username | default(vsd_default_username) }}"
    ansible_become_pass: "{{ vsd_custom_password | default(vsd_default_password) }}"
  become: "{{ 'no' if vsd_custom_username | default(vsd_default_username) == 'root' else 'yes' }}"
  roles:
    - vstat-vsd-health

- hosts: vscs
  gather_facts: no
  vars:
    report_filename: vstat_preupgrade_health_report_for_vsc.txt
  roles:
    - vstat-vsc-health

- hosts: vrss
  gather_facts: no
  vars:
    report_filename: vstat_preupgrade_health_report_for_vrs.txt
  roles:
    - vstat-vrs-health
